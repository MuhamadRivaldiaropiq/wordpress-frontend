import{A as h}from"./index-65396532.js";import{a as c}from"./axiosWp-5be38e33.js";const v=h({id:"article",state:()=>({articles:[],Tags:[],Category:[],loading:!1,error:null}),getters:{allArticle:e=>e.articles,isLoading:e=>e.loading,getError:e=>e.error},actions:{async getArticleByDomain(e,n){this.loading=!0;try{const t=await c.get(`${e}/wp-json/wp/v2/posts`,{params:{status:"any"},headers:{Authorization:`Bearer ${n}`}}).then(s=>{this.articles=s.data})}catch(t){this.error=t}finally{this.loading=!1}},async PublishArticles(e,n,t,s,r){t.value=!0;const i=e.getAll("tagName[]"),l=e.getAll("name_category[]");if(i)for(const o of i){let a=!1;const d=await c.get(`${s}/wp-json/wp/v2/tags`,{params:{search:o}});for(const g of d.data)if(g.name===o){const p=parseInt(g.id);e.append("tags[]",p),a=!0;break}if(!a){const g=await c.post(`${s}/wp-json/wp/v2/tags`,{name:o},{headers:{Authorization:`Bearer ${r}`}}),p=parseInt(g.data.id);e.append("tags[]",p)}}if(l)for(const o of l){let a=!1;const d=await c.get(`${s}/wp-json/wp/v2/categories`,{params:{search:o}});for(const g of d.data)if(g.name===o){const p=parseInt(g.id);e.append("categories[]",p),a=!0;break}if(!a){const g=await c.post(`${s}/wp-json/wp/v2/categories`,{name:o},{headers:{Authorization:`Bearer ${r}`}}),p=parseInt(g.data.id);e.append("categories[]",p)}}await c.post(`${s}/wp-json/wp/v2/posts`,e,{headers:{Authorization:`Bearer ${r}`}}).then(o=>{for(let[a,d]of e)console.log(`${a}: ${d}`);t.value=!1,console.log(o),this.router.push({name:"user.article.index"})}).catch(o=>{if(console.log(o),o.response&&o.response.status===422)n.value=Object.values(o.response.data.code).flat();else if(o.response&&o.response.status===403)n.value=Object.values([o.response.data.code]).flat();else throw o;t.value=!1})},async changeStatus(e,n,t,s,r,i){t.value=!0,await c.post(`${s}/wp-json/wp/v2/posts/${i}`,e,{headers:{Authorization:`Bearer ${r}`}}).then(l=>{console.log(l),t.value=!1}).catch(l=>{if(console.log(l),l.response&&l.response.status===422)n.value=Object.values(l.response.data.code).flat();else if(l.response&&l.response.status===403)n.value=Object.values([l.response.data.code]).flat();else throw l;t.value=!1})},async getTagsbyDomain(e){this.loading=!0;try{const n=await c.get(`${e}/wp-json/wp/v2/tags`).then(t=>{this.Tags=t.data})}catch(n){this.error=n}finally{this.loading=!1}},async getArticleById(e,n,t){this.loading=!0;try{const s=await c.get(`${n}/wp-json/wp/v2/posts/${e}`,{headers:{Authorization:`Bearer ${t}`}});this.articles=s.data}catch(s){this.error=s}finally{this.loading=!1}},async getCategoryByDomain(e){this.loading=!0;try{const n=await c.get(`${e}/wp-json/wp/v2/categories`).then(t=>{this.Category=t.data})}catch(n){this.error=n}finally{this.loading=!1}},async RemoveArticle(e,n,t,s,r){this.loading=!0,r.value=!0,await c.delete(`${n}/wp-json/wp/v2/posts/${e}`,{headers:{Authorization:`Bearer ${t}`}}).then(i=>{r.value=!1,this.articles=this.articles.filter(l=>l.id!==e),console.log(i)}).catch(i=>{if(console.log(i),i.response&&i.response.status===422)s.value=Object.values(i.response.data.code).flat();else if(i.response&&i.response.status===403)s.value=Object.values([i.response.data.code]).flat();else throw i;r.value=!1})},async UpdateArticles(e,n,t,s,r,i){t.value=!0;const l=e.getAll("tagName[]"),o=e.getAll("name_category[]");if(l)for(const a of l){let d=!1;const g=await c.get(`${s}/wp-json/wp/v2/tags`,{params:{search:a}});for(const p of g.data)if(p.name===a){const u=parseInt(p.id);e.append("tags[]",u),d=!0;break}if(!d){const p=await c.post(`${s}/wp-json/wp/v2/tags`,{name:a},{headers:{Authorization:`Bearer ${r}`}}),u=parseInt(p.data.id);e.append("tags[]",u)}}if(o)for(const a of o){let d=!1;const g=await c.get(`${s}/wp-json/wp/v2/categories`,{params:{search:a}});for(const p of g.data)if(p.name===a){const u=parseInt(p.id);e.append("categories[]",u),d=!0;break}if(!d){const p=await c.post(`${s}/wp-json/wp/v2/categories`,{name:a},{headers:{Authorization:`Bearer ${r}`}}),u=parseInt(p.data.id);e.append("categories[]",u)}}await c.post(`${s}/wp-json/wp/v2/posts/${i}`,e,{headers:{Authorization:`Bearer ${r}`}}).then(a=>{t.value=!1,console.log(a),this.router.push({name:"user.article.index"})}).catch(a=>{if(console.log(a),a.response&&a.response.status===422)n.value=Object.values(a.response.data.code).flat();else if(a.response&&a.response.status===403)n.value=Object.values([a.response.data.code]).flat();else throw a;t.value=!1})}}});export{v as u};
